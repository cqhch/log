<!DOCTYPE html><html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<meta name="keywords" content="二手房,爬虫,58同城,赶集ganji">
	
	
	<meta name="description" content="Python实现58同城,赶集网ganji的二手房产信息爬虫">
	
	<title> LAKIA-赶集网和58同城二手房爬虫 - CQH.CH</title>
	
<link rel="stylesheet" href="/css/zerone.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>


<div class="index-about">
    <i> Capital of Quant and Hedge </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/src/avatar.jpg" />
        </div>
        <div class="name">
            <i>CQH.CH</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <span>Home</span>
                </a>
            </li>
            <li >
                <a href="/categories">
                    <span>Categories</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <span>Tags</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <span>Archives</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> Capital of Quant and Hedge </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        <div class="post-container">
    <div class="post-title">
        LAKIA-赶集网和58同城二手房爬虫
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2019-08-11 21:27:20</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#爬虫" title="爬虫">爬虫</a>
        <span>/</span>
        
        
        </span>

    </div>

    <div class="post-content no-indent">
        <p>最近在关注房产信息，天天刷网页或者关注经纪人朋友圈真的是一件极其耗费心神的事情，趁着周末想着写个爬虫自动完成这件事情。</p>
<p><img src="talk-is-cheap-show-me-the-code.jpg" alt="talk-is-cheap-show-me-the-code" title="talk-is-cheap-show-me-the-code"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"># ErShouFang.py</span><br><span class="line"># Ganji.com  58.com 二手房爬虫</span><br><span class="line"># Ande.Studio (c) 2019-08-11</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">from lxml import etree</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">cookies &#x3D; &#123;</span><br><span class="line">&#125;</span><br><span class="line">headers &#x3D; &#123;</span><br><span class="line">    &#39;User-Agent&#39;: &#39;Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:68.0) Gecko&#x2F;20100101 Firefox&#x2F;68.0&#39;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GanjiErShouFang(url):</span><br><span class="line">    response &#x3D; requests.post(url, headers&#x3D;headers, cookies&#x3D;cookies)</span><br><span class="line">    html &#x3D; response.text</span><br><span class="line">    html &#x3D;  etree.HTML(html)</span><br><span class="line">    flist &#x3D; html.xpath(&#39;&#x2F;&#x2F;div[@class&#x3D;&quot;f-list-item ershoufang-list&quot;]&#39;)#房屋信息列表</span><br><span class="line"></span><br><span class="line">    for f in flist:</span><br><span class="line">        title &#x3D; f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item title&quot;]&#x2F;a&#x2F;text()&#39;)[0]#标题</span><br><span class="line">        href &#x3D; f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item title&quot;]&#x2F;a&#x2F;@href&#39;)[0]#链接地址</span><br><span class="line"></span><br><span class="line">        layout &#x3D; f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item size&quot;]&#x2F;span&#x2F;text()&#39;)[0]#布局</span><br><span class="line">        size &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item size&quot;]&#x2F;span&#x2F;text()&#39;)[1]#面积大小</span><br><span class="line">        toward &#x3D; f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item size&quot;]&#x2F;span&#x2F;text()&#39;)[2]#朝向</span><br><span class="line">        floor &#x3D; f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item size&quot;]&#x2F;span&#x2F;text()&#39;)[3]#楼层</span><br><span class="line"></span><br><span class="line">        address &#x3D; f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item address&quot;]&#x2F;span[@class&#x3D;&quot;area&quot;]&#x2F;a&#x2F;text()&#39;)[0]#所在地址</span><br><span class="line">        area &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item address&quot;]&#x2F;&#x2F;span[@class&#x3D;&quot;address-eara&quot;]&#x2F;text()&#39;)[0]#小区</span><br><span class="line"></span><br><span class="line">        organization &#x3D; f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item address&quot;]&#x2F;span[@class&#x3D;&quot;area&quot;]&#x2F;text()&#39;)[3]#发布组织</span><br><span class="line">        organization &#x3D; organization.replace(&quot; &quot;, &#39;&#39;).replace(&quot;－&quot;, &#39;&#39;).replace(&quot;\n&quot;, &#39;&#39;)</span><br><span class="line">        manager &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item address&quot;]&#x2F;&#x2F;span[@class&#x3D;&quot;address-eara&quot;]&#x2F;text()&#39;)[1]#经纪人</span><br><span class="line"></span><br><span class="line">        price &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item info&quot;]&#x2F;div[@class&#x3D;&quot;price&quot;]&#x2F;span[@class&#x3D;&quot;num&quot;]&#x2F;text()&#39;)[0]#房屋总价</span><br><span class="line">        average &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;dd[@class&#x3D;&quot;dd-item info&quot;]&#x2F;div[@class&#x3D;&quot;time&quot;]&#x2F;text()&#39;)[0]#房屋单价</span><br><span class="line">        average &#x3D; average.replace(&quot;元&#x2F;㎡&quot;, &#39;&#39;)</span><br><span class="line">        print(title)</span><br><span class="line">    print(&quot;#&quot;*50)</span><br><span class="line">    try:</span><br><span class="line">        nextpage &#x3D; html.xpath(&#39;&#x2F;&#x2F;div[@class&#x3D;&quot;pageBox&quot;]&#x2F;&#x2F;a[@class&#x3D;&quot;next&quot;]&#x2F;@href&#39;)[0]#下一页</span><br><span class="line">        time.sleep(3)#休息3秒，以防过频繁导致机器人验证</span><br><span class="line">        GanjiErShouFang(nextpage)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">def WubaErShouFang(url):</span><br><span class="line">    response &#x3D; requests.get(url, headers&#x3D;headers)#post will get nothing, get is ok!</span><br><span class="line">    html &#x3D; response.text</span><br><span class="line">    html &#x3D;  etree.HTML(html)</span><br><span class="line">    flist &#x3D; html.xpath(&#39;&#x2F;&#x2F;ul[@class&#x3D;&quot;house-list-wrap&quot;]&#x2F;li&#39;)#房屋信息列表</span><br><span class="line"></span><br><span class="line">    for f in flist:</span><br><span class="line">        title  &#x3D; f.xpath(&#39;.&#x2F;&#x2F;h2[@class&#x3D;&quot;title&quot;]&#x2F;a&#x2F;text()&#39;)[0]</span><br><span class="line">        href &#x3D; f.xpath(&#39;.&#x2F;&#x2F;h2[@class&#x3D;&quot;title&quot;]&#x2F;a&#x2F;@href&#39;)[0]#链接地址</span><br><span class="line"></span><br><span class="line">        layout &#x3D; f.xpath(&#39;.&#x2F;&#x2F;p[@class&#x3D;&quot;baseinfo&quot;]&#x2F;span&#x2F;text()&#39;)[0]#布局</span><br><span class="line">        size &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;p[@class&#x3D;&quot;baseinfo&quot;]&#x2F;span&#x2F;text()&#39;)[1]#面积大小</span><br><span class="line">        toward &#x3D; f.xpath(&#39;.&#x2F;&#x2F;p[@class&#x3D;&quot;baseinfo&quot;]&#x2F;span&#x2F;text()&#39;)[2]#朝向</span><br><span class="line">        floor &#x3D; f.xpath(&#39;.&#x2F;&#x2F;p[@class&#x3D;&quot;baseinfo&quot;]&#x2F;span&#x2F;text()&#39;)[3]#楼层</span><br><span class="line"></span><br><span class="line">        address &#x3D; f.xpath(&#39;.&#x2F;&#x2F;p[@class&#x3D;&quot;baseinfo&quot;]&#x2F;&#x2F;a&#x2F;text()&#39;)[1]#所在地址</span><br><span class="line">        area &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;p[@class&#x3D;&quot;baseinfo&quot;]&#x2F;&#x2F;a&#x2F;text()&#39;)[0]#小区</span><br><span class="line">        #road &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;p[@class&#x3D;&quot;baseinfo&quot;]&#x2F;&#x2F;a&#x2F;text()&#39;)[2]#</span><br><span class="line"></span><br><span class="line">        #organization &#x3D; f.xpath(&#39;.&#x2F;&#x2F;div[@class&#x3D;&quot;jjrinfo&quot;]&#x2F;&#x2F;span[@class&#x3D;&quot;anxuan-qiye-text&quot;]&#x2F;text()&#39;)[0]#发布组织</span><br><span class="line">        #manager &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;div[@class&#x3D;&quot;jjrinfo&quot;]&#x2F;&#x2F;span[@class&#x3D;&quot;jjrname-outer&quot;]&#x2F;text()&#39;)[0]#经纪人</span><br><span class="line">        #当经纪人为个人时， &lt;span class&#x3D;&quot;jjrname-outer anxuan-qiye-text&quot;&gt;xxx&lt;&#x2F;span&gt; 故用class定位将会出现意外</span><br><span class="line"></span><br><span class="line">        organization &#x3D; f.xpath(&#39;.&#x2F;&#x2F;div[@class&#x3D;&quot;jjrinfo&quot;]&#x2F;&#x2F;span&#x2F;text()&#39;)[0]#发布组织</span><br><span class="line">        manager &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;div[@class&#x3D;&quot;jjrinfo&quot;]&#x2F;&#x2F;span&#x2F;text()&#39;)[2]#经纪人</span><br><span class="line"></span><br><span class="line">        price &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;div[@class&#x3D;&quot;price&quot;]&#x2F;p[@class&#x3D;&quot;sum&quot;]&#x2F;b&#x2F;text()&#39;)[0]#房屋总价</span><br><span class="line">        average &#x3D;  f.xpath(&#39;.&#x2F;&#x2F;div[@class&#x3D;&quot;price&quot;]&#x2F;p[@class&#x3D;&quot;unit&quot;]&#x2F;text()&#39;)[0]#房屋单价</span><br><span class="line">        average &#x3D; average.replace(&quot;元&#x2F;㎡&quot;, &#39;&#39;)</span><br><span class="line"></span><br><span class="line">        #time &#x3D; f.xpath(&#39;.&#x2F;&#x2F;div[@class&#x3D;&quot;time&quot;]&#x2F;text()&#39;)[0]#发布时间</span><br><span class="line"></span><br><span class="line">        print(title)</span><br><span class="line">    print(&quot;#&quot;*50)</span><br><span class="line"> </span><br><span class="line">    try:</span><br><span class="line">        nextpage &#x3D; html.xpath(&#39;&#x2F;&#x2F;div[@class&#x3D;&quot;pager&quot;]&#x2F;&#x2F;a[@class&#x3D;&quot;next&quot;]&#x2F;@href&#39;)[0]#下一页</span><br><span class="line">        time.sleep(3)#休息3秒，以防过频繁导致机器人验证</span><br><span class="line">        WubaErShouFang( &#39;https:&#x2F;&#x2F;ganzhou.58.com&#39; + nextpage)</span><br><span class="line">    except:</span><br><span class="line">       pass</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;ganzhou.ganji.com&#x2F;shangyou&#x2F;ershoufang&#x2F;&#39;</span><br><span class="line">GanjiErShouFang(url)</span><br><span class="line"></span><br><span class="line">url &#x3D; &#39;https:&#x2F;&#x2F;ganzhou.58.com&#x2F;shangyou&#x2F;ershoufang&#x2F;&#39;</span><br><span class="line">WubaErShouFang(url)</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<p><img src="ershoufang.png" alt="运行结果" title="运行结果"></p>
<p>本来想着这是一个很小的项目，杀鸡焉用牛刀，所以放弃了使用Scrapy，自己从头写一个爬虫就够用了，但事情并不是如此简单。写爬虫的目的是为了获得数据从而利于决策，并不是简单输出就了事。首先它得提示我新的房产信息，其次它得在众多信息中计算性价比较高的选择，由此就埋下了两个坑。同时，在编程的过程中，我产了两个新的想法：一是对全国的房产数据进行取样制作房价指数，以利投资分析；二是不局限于房产信息，可以抓取其他数据发挥利用的价值。所以到头来，还是得用到框架。</p>

        
        <br />
    </div>
</div>

    </div>
</div>

<footer class="footer">
    <p>&copy; 2022 <a href="http://log.cqh.ch/">CQH</a></p>
</footer>




</body></html>


<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = ""
    window.hexo_root = "/"
    window.isPost = true
</script>


<script src="/js/index.js"></script>


<script src="/js/baidu.js"></script>


<script src="/js/jquery.min.js"></script>

